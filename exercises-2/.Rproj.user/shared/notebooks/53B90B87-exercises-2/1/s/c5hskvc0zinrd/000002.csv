"0","SaratogaHouses$waterfront <- ifelse(SaratogaHouses$waterfront == 'Yes', 1, 0)"
"0","SaratogaHouses$centralAir <- ifelse(SaratogaHouses$centralAir == 'Yes', 1, 0)"
"0","SaratogaHouses$newConstruction <- ifelse(SaratogaHouses$newConstruction == 'Yes', 1, 0)"
"0","SaratogaHouses$heating_electric <- ifelse(SaratogaHouses$heating == 'electric', 1, 0)"
"0","SaratogaHouses$heating_hotwater <- ifelse(SaratogaHouses$heating == 'hot water/steam', 1, 0)"
"0","SaratogaHouses$heating_hotair <- ifelse(SaratogaHouses$heating == 'hot air', 1, 0)"
"0","SaratogaHouses$fuel_electric <- ifelse(SaratogaHouses$fuel == 'electric', 1, 0)"
"0","SaratogaHouses$fuel_gas <- ifelse(SaratogaHouses$fuel == 'gas', 1, 0)"
"0","SaratogaHouses$fuel_oil <- ifelse(SaratogaHouses$fuel == 'oil', 1, 0)"
"0","SaratogaHouses$sewer_septic <- ifelse(SaratogaHouses$sewer == 'septic', 1, 0)"
"0","SaratogaHouses$sewer_public <- ifelse(SaratogaHouses$sewer == 'public/commercial', 1, 0)"
"0","SaratogaHouses$sewer_none <- ifelse(SaratogaHouses$sewer == 'none', 1, 0)"
"0",""
"0","saratoga_split = initial_split(SaratogaHouses, prop = 0.8)"
"0","saratoga_train = training(saratoga_split)"
"0","saratoga_test = testing(saratoga_split)"
"0",""
"0","K_folds = 10"
"0","SaratogaHouses = SaratogaHouses %>%"
"0","  mutate(fold_id = rep(1:K_folds, length=nrow(SaratogaHouses)) %>% sample)"
"0",""
"0","lm_rmse_cv = foreach(fold = 1:K_folds, .combine='c') %do% {"
"0","  lm = lm(price ~ (. -pctCollege - heating - heating_hotair - fuel - fuel_oil - sewer - sewer_none +(bedrooms*lotSize)),"
"0","  data=filter(SaratogaHouses, fold_id != fold))"
"0","modelr::rmse(lm, data=filter(SaratogaHouses, fold_id == fold))"
"0","}"
"0",""
"0","lm_rmse_cv"
"1"," [1]"
"1"," 55594.17"
"1"," 60012.24"
"1"," 56665.68"
"1"," 70669.44"
"1"," 53199.58"
"1"," 57677.97"
"1"," 59452.33"
"1"," 62185.16"
"1"," 61849.61"
"1"," 50710.01"
"1","
"
"0","mean(lm_rmse_cv)"
"1","[1]"
"1"," 58801.62"
"1","
"
"0","SaratogaHouses_standardized = SaratogaHouses %>%"
"0","  mutate(price_s = scale(price), "
"0","         lotSize_s = scale(lotSize),"
"0","         age_s = scale(age),"
"0","         landValue_s = scale(landValue),"
"0","         livingArea_s = scale(livingArea),"
"0","         pctCollege_s = scale(pctCollege),"
"0","         bedrooms_s = scale(bedrooms),"
"0","         fireplaces_s = scale(fireplaces),"
"0","         bathrooms_s = scale(bathrooms),"
"0","         rooms_s = scale(rooms),"
"0","         waterfront_s = scale(waterfront),"
"0","         newConstruction_s = scale(newConstruction),"
"0","         centralAir_s = scale(centralAir),"
"0","         heating_electric_s = scale(heating_electric),"
"0","         heating_hotwater_s = scale(heating_hotwater),"
"0","         heating_hotair_s = scale(heating_hotair),"
"0","         fuel_electric_s = scale(fuel_electric),"
"0","         fuel_gas_s = scale(fuel_gas),"
"0","         fuel_oil_s = scale(fuel_oil),"
"0","         sewer_septic_s = scale(sewer_septic),"
"0","         sewer_public_s = scale(sewer_public),"
"0","         sewer_none_s = scale(sewer_none))"
"0",""
"0","saratoga_split_s = initial_split(SaratogaHouses_standardized, prop = 0.8)"
"0","saratoga_train_s = training(saratoga_split_s)"
"0","saratoga_test_s = testing(saratoga_split_s)"
"0",""
"0","SaratogaHouses_standardized = SaratogaHouses_standardized %>%"
"0","  mutate(fold_id = rep(1:K_folds, length=nrow(SaratogaHouses_standardized)) %>% sample)"
"0",""
"0","knn_rmse_cv = foreach(fold = 1:K_folds, .combine='c') %do% {"
"0","  knn100 = knnreg(price ~(. -pctCollege - heating_hotair - fuel_oil - sewer_none),"
"0","                  data=filter(SaratogaHouses_standardized, fold_id != fold), k=20)"
"0","  modelr::rmse(knn100, data=filter(SaratogaHouses_standardized, fold_id == fold))"
"0","}"
"0",""
"0","knn_rmse_cv"
"1"," [1]"
"1"," 72075.22"
"1"," 70255.16"
"1"," 55671.00"
"1"," 71364.82"
"1"," 82758.14"
"1"," 67877.23"
"1"," 73323.63"
"1"," 67732.20"
"1"," 73172.52"
"1"," 69664.74"
"1","
"
"0","mean(knn_rmse_cv)"
"1","[1]"
"1"," 70389.47"
"1","
"
